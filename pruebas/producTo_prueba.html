<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Truekki - Publicación</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
    }
    .stars {
      display: flex;
      gap: 5px;
      font-size: 25px;
      cursor: pointer;
    }
    .stars span {
      color: #ccc;
    }
    .stars span.active {
      color: gold;
    }
    canvas {
      max-width: 300px;
      margin: 10px 0;
    }
    .comment-box {
      margin-top: 20px;
      background: #eaf0f9;
      padding: 10px;
      border-radius: 10px;
    }
    .comment-box textarea {
      width: 100%;
      height: 60px;
      border-radius: 8px;
      border: 1px solid #ccc;
      padding: 8px;
    }
    .comment-box button {
      margin-top: 8px;
      padding: 8px 12px;
      border: none;
      border-radius: 8px;
      background: #007bff;
      color: white;
      cursor: pointer;
    }
    .comment-list {
      margin-top: 15px;
    }
    .comment-item {
      background: #fff;
      padding: 8px;
      border-radius: 8px;
      margin-bottom: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <!-- Bloque del vendedor -->
  <div>
    <h2>Calificación del Vendedor</h2>
    <div class="stars" id="stars">
      <span data-value="1">&#9733;</span>
      <span data-value="2">&#9733;</span>
      <span data-value="3">&#9733;</span>
      <span data-value="4">&#9733;</span>
      <span data-value="5">&#9733;</span>
    </div>
    <canvas id="ratingChart"></canvas>
  </div>

  <!-- Comentarios -->
  <div class="comment-box">
    <h3>Comentarios</h3>
    <textarea id="commentInput" placeholder="Escribe tu comentario..."></textarea>
    <button onclick="addComment()">Publicar</button>
    <div class="comment-list" id="commentList"></div>
  </div>

  <!-- Script -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const stars = document.querySelectorAll("#stars span");
    const ratingData = [0, 0, 0, 0, 0];
    let chart;

    // Inicializar gráfica
    function renderChart() {
      const ctx = document.getElementById("ratingChart").getContext("2d");
      if (chart) chart.destroy();

      chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ["1 estrella", "2 estrellas", "3 estrellas", "4 estrellas", "5 estrellas"],
          datasets: [{
            label: "Número de votos",
            data: ratingData,
            backgroundColor: "rgba(255, 206, 86, 0.7)",
            borderColor: "rgba(255, 159, 64, 1)",
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            y: { beginAtZero: true }
          }
        }
      });
    }

    renderChart();

    // Manejar clic en estrellas
    stars.forEach(star => {
      star.addEventListener("click", () => {
        const value = star.getAttribute("data-value");
        ratingData[value - 1]++;
        renderChart();

        stars.forEach(s => s.classList.remove("active"));
        for (let i = 0; i < value; i++) {
          stars[i].classList.add("active");
        }
      });
    });

    // Sistema de comentarios
    function addComment() {
      const input = document.getElementById("commentInput");
      const list = document.getElementById("commentList");

      if (input.value.trim() === "") return;

      const comment = document.createElement("div");
      comment.classList.add("comment-item");
      comment.textContent = input.value;
      list.appendChild(comment);

      input.value = "";
    }
  </script>
</body>
</html>
